<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <title>nmedea — Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:opsz,wght@9..40,300;9..40,400;9..40,500;9..40,700&display=swap" rel="stylesheet">
    <script src="https://js.yoco.com/sdk/v1/yoco-sdk-web.js"></script>

    <style>
        :root {
            --black:  #0b0b0b;
            --white:  #f3f3ee;
            --dim:    #555;
            --muted:  #1c1c1c;
            --border: rgba(243,243,238,0.09);
            --green:  #22c55e;
            --amber:  #f59e0b;
            --red:    #ef4444;
        }

        /* ── LIGHT THEME ── */
        body.light {
            --black:  #f3f3ee;
            --white:  #0b0b0b;
            --dim:    #888;
            --muted:  #e0e0d8;
            --border: rgba(11,11,11,0.1);
            --green:  #16a34a;
            --amber:  #d97706;
            --red:    #dc2626;
        }
        body.light .topnav { background: rgba(243,243,238,0.96); }
        body.light .sidebar { background: #f3f3ee; }
        body.light .drop { background: #f0f0eb; }
        body.light .mbox { background: #f0f0eb; }
        body.light .confirm-box { background: #f0f0eb; }
        body.light .bal-card { background: #0b0b0b; color: #f3f3ee; }
        body.light .bal-lbl { color: rgba(243,243,238,.45); }
        body.light .bal-sub { color: rgba(243,243,238,.45); }
        body.light .bal-icon { background: rgba(243,243,238,.12); }
        body.light .bal-icon svg { color: #f3f3ee; }
        body.light .card-prev { background: #0b0b0b; color: #f3f3ee; }
        body.light .cp-lbl { color: rgba(243,243,238,.38); }
        body.light .cp-num { color: #f3f3ee; }
        body.light .cp-f { color: rgba(243,243,238,.38); }
        body.light .cp-v { color: #f3f3ee; }
        body.light .bg-grid {
            background-image:
                linear-gradient(rgba(11,11,11,.04) 1px, transparent 1px),
                linear-gradient(90deg, rgba(11,11,11,.04) 1px, transparent 1px);
        }
        body.light .proc { background: rgba(243,243,238,.88); }
        body.light .proc-txt { color: rgba(11,11,11,.55); }
        body.light .proc-spin { border-color: rgba(11,11,11,.1); border-top-color: #0b0b0b; }
        body.light .srv { background: rgba(11,11,11,.03); }
        body.light .srv:hover:not(.reserved) { background: rgba(11,11,11,.06); }
        body.light .mf input, body.light .mr input { background: rgba(11,11,11,.05); border-color: rgba(11,11,11,.1); color: #0b0b0b; }
        body.light .mf input::placeholder, body.light .mr input::placeholder { color: rgba(11,11,11,.3); }
        body.light .mf input:focus, body.light .mr input:focus { border-color: rgba(11,11,11,.4); background: rgba(11,11,11,.08); }
        body.light .sc { background: rgba(11,11,11,.03); }
        body.light .sc-ico { background: rgba(11,11,11,.07); }
        body.light .fund-btn { background: rgba(11,11,11,.05); color: #0b0b0b; }
        body.light .fund-btn:hover { background: rgba(11,11,11,.1); }
        body.light .fund-btn.withdraw { color: #888; }
        body.light .fund-btn.withdraw:hover { color: #0b0b0b; }
        body.light .nav-bal { background: rgba(11,11,11,.06); }
        body.light .avatar { background: rgba(11,11,11,.08); }
        body.light .toast { background: #0b0b0b; color: #f3f3ee; }
        body.light .di { color: rgba(11,11,11,.65); }
        body.light .di:hover { background: rgba(11,11,11,.07); color: #0b0b0b; }
        body.light .slink { color: rgba(11,11,11,.45); }
        body.light .slink:hover { background: rgba(11,11,11,.06); color: #0b0b0b; }
        body.light .slink.active { background: rgba(11,11,11,.1); color: #0b0b0b; }
        body.light .btn-cancel-c { background: rgba(11,11,11,.06); border-color: rgba(11,11,11,.1); color: #0b0b0b; }
        body.light .btn-confirm-c { background: #0b0b0b; color: #f3f3ee; }
        body.light .srv-btn { background: #0b0b0b; color: #f3f3ee; }
        body.light .srv-btn::after { background: #333; }
        body.light .srv-btn:hover span { color: #f3f3ee; }
        body.light .btn-pay { background: #0b0b0b; color: #f3f3ee; }
        body.light .btn-pay::after { background: #333; }
        body.light .btn-pay:hover .bt { color: #f3f3ee; }
        body.light .m-close { background: rgba(11,11,11,.07); color: #555; }
        body.light .m-close:hover { background: rgba(11,11,11,.13); color: #0b0b0b; }
        body.light .slots-vs { color: #888; }
        body.light .slot { border-color: rgba(11,11,11,.15); color: rgba(11,11,11,.3); }
        body.light .slot.filled { border-color: rgba(11,11,11,.25); background: rgba(11,11,11,.06); color: rgba(11,11,11,.7); }
        body.light .srv-name { color: #0b0b0b; }
        body.light .srv-info { color: #888; }
        body.light .sec-note { color: #888; border-color: rgba(11,11,11,.15); }
        body.light .sc { border-color: rgba(11,11,11,.1); }
        body.light .sc:hover { border-color: rgba(11,11,11,.25); }
        body.light .hist-item { border-color: rgba(11,11,11,.1); }
        body.light .hist-item:hover { border-color: rgba(11,11,11,.25); }
        body.light .hist-title { color: #0b0b0b; }
        body.light .hist-time { color: #888; }
        body.light .hist-amt.neu { color: #0b0b0b; }
        body.light .wd-req { border-color: rgba(11,11,11,.1); }
        body.light .mob-sheet { background: #f3f3ee; border-color: rgba(11,11,11,.1); }
        body.light .mob-sheet-name { color: #0b0b0b; }
        body.light .mob-sheet-avatar { background: rgba(11,11,11,.08); border-color: rgba(11,11,11,.1); color: #0b0b0b; }
        body.light .mob-sheet-item { color: #0b0b0b; }
        body.light .mob-sheet-sep { background: rgba(11,11,11,.1); }
        body.light .drop-name { color: #0b0b0b; }

        *, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }

        html, body {
            font-family: 'DM Sans', sans-serif;
            background: var(--black);
            color: var(--white);
            min-height: 100dvh;
            overflow-x: hidden;
            max-width: 100vw;
            transition: background .3s, color .3s;
        }

        /* ── BACKGROUND GRID ── */
        .bg-grid {
            position: fixed; inset: 0; z-index: 0; pointer-events: none;
            background-image:
                linear-gradient(rgba(243,243,238,.026) 1px, transparent 1px),
                linear-gradient(90deg, rgba(243,243,238,.026) 1px, transparent 1px);
            background-size: 52px 52px;
            animation: drift 24s linear infinite;
        }
        @keyframes drift { to { background-position: 52px 52px; } }

        /* ── SHELL ── */
        .shell {
            position: relative; z-index: 1;
            display: grid;
            grid-template-columns: 240px 1fr;
            grid-template-rows: 62px 1fr;
            min-height: 100dvh;
        }

        /* ══ TOP NAV ══ */
        .topnav {
            grid-column: 1 / -1;
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 24px;
            height: 62px;
            border-bottom: 1px solid var(--border);
            background: rgba(11,11,11,0.96);
            backdrop-filter: blur(14px);
            position: sticky; top: 0; z-index: 100;
            transition: background .3s;
        }

        .nav-logo { display: flex; align-items: center; gap: 10px; text-decoration: none; }
        .logo-mark {
            width: 34px; height: 34px; background: var(--white);
            border-radius: 7px; display: grid; place-items: center; flex-shrink: 0;
            transition: background .3s;
        }
        .logo-mark svg { width: 20px; height: 20px; color: var(--black); }

        /* Custom two-dot loader */
        .dot-loader {
            display: flex; align-items: center; gap: 10px;
        }
        .dot-loader span {
            width: 11px; height: 11px; border-radius: 50%;
            background: var(--white);
            display: block;
            animation: dotBounce 1.1s cubic-bezier(.4,0,.6,1) infinite;
            transition: background .3s;
        }
        .dot-loader span:nth-child(1) { animation-delay: 0s; }
        .dot-loader span:nth-child(2) { animation-delay: .2s; }
        .dot-loader span:nth-child(3) { animation-delay: .4s; }
        @keyframes dotBounce {
            0%, 80%, 100% { transform: translateY(0); opacity: .25; }
            40%            { transform: translateY(-16px); opacity: 1; }
        }
        .proc-txt { font-size: 11px; color: rgba(243,243,238,.4); letter-spacing: 2.5px; text-transform: uppercase; margin-top: 4px; }
        body.light .dot-loader span { background: #0b0b0b; }
        body.light .proc-txt { color: rgba(11,11,11,.4); }
        .logo-text { font-family: 'Bebas Neue', sans-serif; font-size: 18px; letter-spacing: 3px; color: var(--white); transition: color .3s; }

        .nav-right { display: flex; align-items: center; gap: 12px; }

        .nav-bal {
            display: flex; align-items: center; gap: 7px;
            padding: 7px 14px;
            background: rgba(243,243,238,.06);
            border: 1px solid var(--border);
            border-radius: 100px;
            font-size: 13px; font-weight: 600;
            transition: background .3s;
        }
        .nav-bal svg { width: 13px; height: 13px; color: var(--dim); flex-shrink: 0; }
        .nav-bal-amt { font-family: 'Bebas Neue', sans-serif; font-size: 17px; letter-spacing: 1px; }

        .avatar {
            width: 36px; height: 36px; border-radius: 50%;
            background: var(--muted); border: 1.5px solid var(--border);
            display: grid; place-items: center; cursor: pointer;
            font-family: 'Bebas Neue', sans-serif; font-size: 15px;
            transition: border-color .2s, background .2s;
            position: relative; flex-shrink: 0; user-select: none;
        }
        .avatar:hover { border-color: rgba(243,243,238,.35); background: rgba(243,243,238,.08); }

        /* Dropdown */
        .drop {
            position: absolute; top: calc(100% + 10px); right: 0;
            background: #111; border: 1px solid var(--border);
            border-radius: 12px; min-width: 196px;
            padding: 6px; display: none; z-index: 200;
            box-shadow: 0 20px 50px rgba(0,0,0,.65);
            transition: background .3s;
        }
        .drop.open { display: block; animation: dropIn .22s cubic-bezier(.16,1,.3,1); }
        @keyframes dropIn { from{opacity:0;transform:translateY(-8px)} to{opacity:1;transform:translateY(0)} }

        .drop-hd {
            padding: 11px 13px 9px;
            border-bottom: 1px solid var(--border);
            margin-bottom: 4px;
        }
        .drop-name  { font-weight: 700; font-size: 13.5px; }
        .drop-email { font-size: 11px; color: var(--dim); margin-top: 2px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; max-width: 160px; }

        .di {
            display: flex; align-items: center; gap: 10px;
            padding: 9px 13px; border-radius: 8px; cursor: pointer;
            font-size: 13px; color: rgba(243,243,238,.7);
            transition: background .15s, color .15s;
        }
        .di svg { width: 14px; height: 14px; flex-shrink: 0; }
        .di:hover { background: rgba(243,243,238,.07); color: var(--white); }
        .di.red { color: #f87171; }
        .di.red:hover { background: rgba(248,113,113,.1); color: #f87171; }
        .drop-sep { height: 1px; background: var(--border); margin: 4px 0; }

        /* Theme toggle in dropdown */
        .di.theme-toggle { justify-content: space-between; }
        .toggle-switch {
            width: 34px; height: 18px; background: rgba(243,243,238,.15);
            border-radius: 100px; position: relative; flex-shrink: 0;
            transition: background .3s;
        }
        .toggle-switch.on { background: var(--white); }
        .toggle-knob {
            position: absolute; top: 2px; left: 2px;
            width: 14px; height: 14px; border-radius: 50%;
            background: var(--black); transition: transform .3s, background .3s;
        }
        .toggle-switch.on .toggle-knob { transform: translateX(16px); background: var(--black); }

        /* ══ SIDEBAR ══ */
        .sidebar {
            border-right: 1px solid var(--border);
            padding: 20px 14px;
            display: flex; flex-direction: column; gap: 2px;
            transition: background .3s;
        }

        .s-lbl {
            font-size: 10px; letter-spacing: 2px; text-transform: uppercase;
            color: var(--dim); padding: 0 10px;
            margin: 12px 0 6px;
        }
        .s-lbl:first-child { margin-top: 0; }

        .slink {
            display: flex; align-items: center; gap: 10px;
            padding: 9px 11px; border-radius: 9px; cursor: pointer;
            font-size: 13px; color: rgba(243,243,238,.5);
            transition: background .15s, color .15s; text-decoration: none;
        }
        .slink svg { width: 15px; height: 15px; flex-shrink: 0; }
        .slink:hover  { background: rgba(243,243,238,.06); color: var(--white); }
        .slink.active { background: rgba(243,243,238,.1);  color: var(--white); font-weight: 600; }
        .slink.red    { color: #f87171; margin-top: auto; }
        .slink.red:hover { background: rgba(248,113,113,.08); }

        /* ══ MAIN ══ */
        .main {
            overflow-y: auto;
            padding: clamp(18px, 3vw, 32px);
        }

        .pg-eyebrow {
            font-size: 10px; letter-spacing: 2.5px; text-transform: uppercase;
            color: var(--dim); margin-bottom: 5px;
        }
        .pg-title {
            font-family: 'Bebas Neue', sans-serif;
            font-size: clamp(28px, 3.5vw, 42px);
            letter-spacing: 1px; line-height: 1;
            margin-bottom: clamp(18px, 2.5vh, 28px);
        }

        /* ── STATS ── */
        .stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: clamp(16px, 2.5vh, 24px);
        }

        .sc {
            background: rgba(243,243,238,.04);
            border: 1px solid var(--border);
            border-radius: 13px; padding: 18px 20px;
            transition: border-color .3s, background .3s;
        }
        .sc:hover { border-color: rgba(243,243,238,.2); }
        .sc-top {
            display: flex; align-items: center; justify-content: space-between;
            margin-bottom: 10px;
        }
        .sc-lbl { font-size: 10px; letter-spacing: 1.5px; text-transform: uppercase; color: var(--dim); }
        .sc-ico { width: 26px; height: 26px; background: rgba(243,243,238,.07); border-radius: 7px; display: grid; place-items: center; transition: background .3s; }
        .sc-ico svg { width: 13px; height: 13px; color: var(--white); }
        .sc-val { font-family: 'Bebas Neue', sans-serif; font-size: clamp(26px, 2.8vw, 36px); letter-spacing: 1px; line-height: 1; }
        .sc-sub { font-size: 11px; color: var(--dim); margin-top: 3px; }

        /* ── BALANCE SECTION ── */
        .bal-section {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 12px;
            margin-bottom: clamp(20px, 3vh, 30px);
            align-items: stretch;
            min-width: 0;
            overflow: hidden;
        }

        .bal-card {
            background: var(--white); color: var(--black);
            border-radius: 16px; padding: clamp(16px,2.5vh,24px) clamp(16px,2.5vw,24px);
            display: flex; align-items: center; justify-content: space-between;
            position: relative; overflow: hidden;
            min-width: 0; transition: background .3s, color .3s;
        }
        .bal-card::before {
            content: ''; position: absolute; top: -40px; right: -40px;
            width: 150px; height: 150px; border-radius: 50%;
            background: rgba(11,11,11,.06);
        }
        .bal-lbl { font-size: 10px; letter-spacing: 2px; text-transform: uppercase; color: rgba(11,11,11,.4); margin-bottom: 5px; }
        .bal-big { font-family: 'Bebas Neue', sans-serif; font-size: clamp(30px,4vw,52px); letter-spacing: 1px; line-height: 1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 100%; }
        .bal-sub { font-size: 11px; color: rgba(11,11,11,.4); margin-top: 3px; white-space: nowrap; }
        .bal-icon { width: 48px; height: 48px; background: rgba(11,11,11,.08); border-radius: 12px; display: grid; place-items: center; position: relative; z-index: 1; flex-shrink: 0; }
        .bal-icon svg { width: 24px; height: 24px; color: var(--black); }

        .fund-col {
            display: flex; flex-direction: column; gap: 10px;
            flex-shrink: 0;
        }
        .fund-btn {
            padding: 14px 20px;
            background: rgba(243,243,238,.05);
            border: 1px solid var(--border);
            border-radius: 12px; cursor: pointer;
            font-family: 'DM Sans', sans-serif;
            font-size: 13px; font-weight: 700; color: var(--white);
            transition: background .2s, border-color .2s, color .3s;
            display: flex; align-items: center; justify-content: center; gap: 7px;
            white-space: nowrap; min-width: 120px;
        }
        .fund-btn svg { width: 14px; height: 14px; flex-shrink: 0; }
        .fund-btn:hover { background: rgba(243,243,238,.1); border-color: rgba(243,243,238,.3); }
        .fund-btn.withdraw {
            background: rgba(243,243,238,.03);
            border-style: dashed;
            color: var(--dim);
        }
        .fund-btn.withdraw:hover { background: rgba(243,243,238,.07); color: var(--white); border-color: rgba(243,243,238,.25); }

        /* ── SERVERS ── */
        .sec-row {
            display: flex; align-items: center; justify-content: space-between;
            margin-bottom: 14px;
        }
        .sec-ttl { font-family: 'Bebas Neue', sans-serif; font-size: 22px; letter-spacing: 1px; }
        .sec-note {
            font-size: 11px; letter-spacing: 1px; text-transform: uppercase;
            padding: 4px 11px; border: 1px solid var(--border);
            border-radius: 100px; color: var(--dim);
        }

        .server-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .srv {
            background: rgba(243,243,238,.04);
            border: 1px solid var(--border);
            border-radius: 14px; padding: 18px 20px;
            cursor: pointer; position: relative; overflow: hidden;
            transition: border-color .25s, background .25s, transform .2s;
            display: flex; flex-direction: column; gap: 14px;
        }
        .srv:hover:not(.reserved) { border-color: rgba(243,243,238,.26); background: rgba(243,243,238,.07); transform: translateY(-2px); }
        .srv:active:not(.reserved) { transform: scale(.99); }
        .srv.reserved { cursor: not-allowed; opacity: .55; }

        .srv-top { display: flex; align-items: center; justify-content: space-between; }
        .srv-name { font-family: 'Bebas Neue', sans-serif; font-size: 19px; letter-spacing: 1px; }

        .srv-badge {
            display: flex; align-items: center; gap: 5px;
            font-size: 10px; font-weight: 700; letter-spacing: 1.5px; text-transform: uppercase;
            padding: 4px 10px; border-radius: 100px;
        }
        .srv-badge svg { width: 6px; height: 6px; flex-shrink: 0; }

        .badge-open     { background: rgba(34,197,94,.12);  color: var(--green); border: 1px solid rgba(34,197,94,.25); }
        .badge-waiting  { background: rgba(245,158,11,.12); color: var(--amber); border: 1px solid rgba(245,158,11,.25); }
        .badge-reserved { background: rgba(239,68,68,.12);  color: var(--red);   border: 1px solid rgba(239,68,68,.25); }

        .dot-green { animation: blinkG 2s infinite; }
        .dot-amber { animation: blinkA 1.2s infinite; }
        .dot-red   { background: var(--red) !important; }

        @keyframes blinkG { 0%,100%{opacity:1} 50%{opacity:.2} }
        @keyframes blinkA { 0%,100%{opacity:1} 50%{opacity:.3} }

        .srv-info {
            display: flex; align-items: center; gap: 14px;
            font-size: 12px; color: var(--dim);
        }
        .srv-info-item { display: flex; align-items: center; gap: 5px; }
        .srv-info-item svg { width: 12px; height: 12px; }

        .slots { display: flex; gap: 8px; align-items: center; }
        .slot {
            height: 32px; flex: 1;
            border: 1.5px dashed rgba(243,243,238,.15);
            border-radius: 8px; display: flex; align-items: center; justify-content: center;
            font-size: 10px; letter-spacing: 1px; text-transform: uppercase; color: rgba(243,243,238,.25);
            transition: all .3s;
        }
        .slot.filled {
            border-style: solid; border-color: rgba(243,243,238,.25);
            background: rgba(243,243,238,.06); color: rgba(243,243,238,.6);
            font-size: 11px;
        }
        .slots-vs {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 14px; color: var(--dim); flex-shrink: 0;
        }

        .srv-btn {
            width: 100%; padding: 11px;
            background: var(--white); color: var(--black);
            border: none; border-radius: 9px;
            font-family: 'DM Sans', sans-serif;
            font-size: 12px; font-weight: 800;
            letter-spacing: 1.5px; text-transform: uppercase;
            cursor: pointer; position: relative; overflow: hidden;
            transition: transform .18s;
        }
        .srv-btn::after {
            content: ''; position: absolute; inset: 0;
            background: #222; transform: translateY(102%);
            transition: transform .35s cubic-bezier(.16,1,.3,1);
        }
        .srv-btn:hover::after { transform: translateY(0); }
        .srv-btn span { position: relative; z-index: 1; transition: color .3s; }
        .srv-btn:hover span { color: var(--white); }
        .srv-btn:active { transform: scale(.98); }
        .srv-btn:disabled { opacity: .4; cursor: not-allowed; }

        /* ══ HISTORY PANEL ══ */
        .history-panel {
            display: none;
        }
        .history-panel.active { display: block; }

        .hist-list { display: flex; flex-direction: column; gap: 8px; }
        .hist-item {
            display: flex; align-items: center; justify-content: space-between;
            padding: 14px 18px;
            background: rgba(243,243,238,.04);
            border: 1px solid var(--border);
            border-radius: 12px;
            transition: border-color .2s;
        }
        .hist-item:hover { border-color: rgba(243,243,238,.2); }
        .hist-left { display: flex; align-items: center; gap: 12px; }
        .hist-ico {
            width: 36px; height: 36px; border-radius: 9px;
            display: grid; place-items: center; flex-shrink: 0;
        }
        .hist-ico svg { width: 16px; height: 16px; }
        .hist-ico.win  { background: rgba(34,197,94,.12);  color: var(--green); }
        .hist-ico.loss { background: rgba(239,68,68,.12);  color: var(--red); }
        .hist-ico.dep  { background: rgba(243,243,238,.08); color: var(--white); }
        .hist-ico.with { background: rgba(245,158,11,.12); color: var(--amber); }
        .hist-title { font-weight: 600; font-size: 13.5px; }
        .hist-time  { font-size: 11px; color: var(--dim); margin-top: 2px; }
        .hist-amt { font-family: 'Bebas Neue', sans-serif; font-size: 20px; letter-spacing: 1px; }
        .hist-amt.pos { color: var(--green); }
        .hist-amt.neg { color: var(--red); }
        .hist-amt.neu { color: var(--white); }
        .hist-empty {
            text-align: center; padding: 60px 20px;
            color: var(--dim); font-size: 14px;
        }
        .hist-empty-ico { margin-bottom: 12px; color: var(--dim); display: flex; justify-content: center; }

        /* ══ WITHDRAW MODAL ══ */
        .overlay {
            position: fixed; inset: 0; z-index: 300;
            background: rgba(0,0,0,.78);
            backdrop-filter: blur(5px);
            display: none; align-items: center; justify-content: center; padding: 20px;
            overflow-y: auto;
        }
        .overlay.open { display: flex; }
        html.modal-open,
        body.modal-open {
            overflow: hidden !important;
            position: fixed !important;
            width: 100% !important;
            /* keep scroll position when locking */
        }

        /* Force Yoco iframe/overlay to fit viewport properly */
        body > iframe,
        body > div[style*="position: fixed"],
        body > div[style*="position:fixed"] {
            max-height: 100dvh !important;
            overflow-y: auto !important;
        }

        .mbox {
            background: #111; border: 1px solid var(--border);
            border-radius: 20px; width: 100%; max-width: 400px;
            padding: clamp(22px,3vw,32px);
            animation: modalIn .28s cubic-bezier(.16,1,.3,1);
            transition: background .3s;
        }
        @keyframes modalIn { from{opacity:0;transform:scale(.9)} to{opacity:1;transform:scale(1)} }

        .m-head {
            display: flex; align-items: center; justify-content: space-between;
            margin-bottom: 22px;
        }
        .m-title { font-family: 'Bebas Neue', sans-serif; font-size: 26px; letter-spacing: 1px; }
        .m-close {
            width: 30px; height: 30px; background: rgba(243,243,238,.07);
            border: none; border-radius: 7px; cursor: pointer;
            color: var(--dim); display: grid; place-items: center;
            transition: background .2s;
        }
        .m-close:hover { background: rgba(243,243,238,.13); color: var(--white); }
        .m-close svg { width: 14px; height: 14px; }

        /* Card preview */
        .card-prev {
            background: var(--white); color: var(--black);
            border-radius: 13px; padding: 20px 22px;
            margin-bottom: 20px; position: relative; overflow: hidden;
            transition: background .3s, color .3s;
        }
        .card-prev::before {
            content: ''; position: absolute; top: -30px; right: -30px;
            width: 120px; height: 120px; border-radius: 50%;
            background: rgba(11,11,11,.07);
        }
        .cp-lbl { font-size: 9px; letter-spacing: 2px; text-transform: uppercase; color: rgba(11,11,11,.38); }
        .cp-num { font-family: 'DM Sans', sans-serif; font-size: 17px; font-weight: 700; letter-spacing: 3px; margin: 10px 0; color: var(--black); }
        .cp-row { display: flex; justify-content: space-between; margin-top: 8px; }
        .cp-f   { font-size: 9px; letter-spacing: 1.5px; text-transform: uppercase; color: rgba(11,11,11,.38); margin-bottom: 2px; }
        .cp-v   { font-size: 13px; font-weight: 600; color: var(--black); }

        .mf { margin-bottom: 12px; }
        .mf label { display: block; font-size: 10px; letter-spacing: 2px; text-transform: uppercase; color: rgba(243,243,238,.33); margin-bottom: 7px; }
        .mr { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 12px; }

        .mf input, .mr input {
            width: 100%; padding: 12px 14px;
            background: rgba(243,243,238,.05);
            border: 1.5px solid rgba(243,243,238,.08);
            border-radius: 9px; color: var(--white);
            font-family: 'DM Sans', sans-serif; font-size: 15px;
            outline: none; -webkit-appearance: none;
            transition: border-color .2s, background .2s;
        }
        .mf input::placeholder, .mr input::placeholder { color: rgba(243,243,238,.18); font-size: 13px; }
        .mf input:focus, .mr input:focus { border-color: rgba(243,243,238,.42); background: rgba(243,243,238,.08); }

        .pay-amt { text-align: center; margin: 16px 0 20px; }
        .pay-amt-lbl { font-size: 10px; letter-spacing: 2px; text-transform: uppercase; color: var(--dim); margin-bottom: 4px; }
        .pay-amt-val { font-family: 'Bebas Neue', sans-serif; font-size: 46px; letter-spacing: 2px; }

        .btn-pay {
            width: 100%; padding: 15px;
            background: var(--white); color: var(--black);
            border: none; border-radius: 9px;
            font-family: 'DM Sans', sans-serif;
            font-size: 13px; font-weight: 800; letter-spacing: 2px; text-transform: uppercase;
            cursor: pointer; position: relative; overflow: hidden;
            transition: transform .18s;
        }
        .btn-pay::after { content: ''; position: absolute; inset: 0; background: #1c1c1c; transform: translateY(102%); transition: transform .4s cubic-bezier(.16,1,.3,1); }
        .btn-pay:hover::after { transform: translateY(0); }
        .btn-pay .bt { position: relative; z-index: 1; transition: color .3s; }
        .btn-pay:hover .bt { color: var(--white); }
        .btn-pay:active { transform: scale(.98); }
        .btn-pay.ld .bt { opacity: 0; }
        .btn-pay.ld::before {
            content: ''; position: absolute; z-index: 2;
            width: 20px; height: 20px;
            border: 2.5px solid rgba(10,10,10,.15);
            border-top-color: var(--black);
            border-radius: 50%; animation: rot .65s linear infinite;
            top: 50%; left: 50%; transform: translate(-50%,-50%);
        }
        @keyframes rot { to { transform: translate(-50%,-50%) rotate(360deg); } }

        /* Withdraw modal specific */
        .wd-info {
            background: rgba(245,158,11,.08);
            border: 1px solid rgba(245,158,11,.2);
            border-radius: 10px; padding: 14px 16px;
            font-size: 12.5px; color: var(--amber);
            margin-bottom: 16px; line-height: 1.5;
        }
        .wd-req {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 16px; padding: 12px 14px;
            background: rgba(243,243,238,.04);
            border: 1px solid var(--border); border-radius: 10px;
            font-size: 13px;
        }
        .wd-req-lbl { color: var(--dim); }
        .wd-req-val { font-family: 'Bebas Neue', sans-serif; font-size: 18px; }

        /* ══ SECTION FADE ══ */
        .section-panel {
            animation: fadeIn .22s ease;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }

        /* ══ PROCESSING OVERLAY ══ */
        .proc {
            position: fixed; inset: 0; z-index: 9999;
            background: rgba(0,0,0,.97);
            display: none; flex-direction: column;
            align-items: center; justify-content: center; gap: 18px;
        }
        .proc.open { display: flex; }
        body.light .proc { background: rgba(243,243,238,.97); }

        /* Simple clean dot loader */
        .dot-loader { display: flex; align-items: center; gap: 8px; }
        .dot-loader span {
            width: 8px; height: 8px; border-radius: 50%;
            background: var(--white);
            animation: dotPulse 1.2s ease-in-out infinite;
            transition: background .3s;
        }
        .dot-loader span:nth-child(1) { animation-delay: 0s; }
        .dot-loader span:nth-child(2) { animation-delay: .2s; }
        .dot-loader span:nth-child(3) { animation-delay: .4s; }
        @keyframes dotPulse {
            0%, 100% { transform: scale(1); opacity: .3; }
            50%       { transform: scale(1.6); opacity: 1; }
        }
        body.light .dot-loader span { background: #0b0b0b; }
        .proc-txt {
            font-size: 11px; letter-spacing: 3px; text-transform: uppercase;
            color: rgba(243,243,238,.35);
        }
        body.light .proc-txt { color: rgba(11,11,11,.35); }

        /* ══ CONFIRM DIALOG ══ */
        .confirm-overlay {
            position: fixed; inset: 0; z-index: 500;
            background: rgba(0,0,0,.8);
            backdrop-filter: blur(6px);
            display: none; align-items: center; justify-content: center; padding: 20px;
        }
        .confirm-overlay.open { display: flex; }
        .confirm-box {
            background: #111; border: 1px solid var(--border);
            border-radius: 18px; padding: 30px;
            max-width: 360px; width: 100%;
            animation: modalIn .25s cubic-bezier(.16,1,.3,1);
            transition: background .3s;
        }
        .confirm-icon {
            width: 48px; height: 48px; background: rgba(243,243,238,.07);
            border-radius: 12px; display: grid; place-items: center;
            margin-bottom: 16px;
        }
        .confirm-icon svg { width: 22px; height: 22px; color: var(--white); }
        .confirm-title { font-family: 'Bebas Neue', sans-serif; font-size: 24px; letter-spacing: 1px; margin-bottom: 8px; }
        .confirm-msg { font-size: 13.5px; color: var(--dim); line-height: 1.6; margin-bottom: 24px; }
        .confirm-btns { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .btn-cancel-c {
            padding: 13px; background: rgba(243,243,238,.06);
            border: 1px solid var(--border); border-radius: 9px;
            color: var(--white); font-family: 'DM Sans', sans-serif;
            font-size: 13px; font-weight: 600; cursor: pointer;
            transition: background .2s;
        }
        .btn-cancel-c:hover { background: rgba(243,243,238,.1); }
        .btn-confirm-c {
            padding: 13px; background: var(--white);
            border: none; border-radius: 9px;
            color: var(--black); font-family: 'DM Sans', sans-serif;
            font-size: 13px; font-weight: 800; cursor: pointer;
            letter-spacing: 1px; text-transform: uppercase;
            transition: opacity .2s;
        }
        .btn-confirm-c:hover { opacity: .85; }

        /* ══ TOAST ══ */
        .toast {
            position: fixed; bottom: 24px; left: 50%;
            transform: translateX(-50%) translateY(70px);
            background: var(--white); color: var(--black);
            padding: 12px 22px; border-radius: 100px;
            font-size: 13px; font-weight: 700;
            z-index: 600; white-space: nowrap;
            box-shadow: 0 8px 30px rgba(0,0,0,.45);
            transition: transform .38s cubic-bezier(.16,1,.3,1), background .3s, color .3s;
            display: flex; align-items: center; gap: 8px;
        }
        .toast.show { transform: translateX(-50%) translateY(0); }
        .toast svg { width: 14px; height: 14px; flex-shrink: 0; }
        .toast.success svg { color: var(--green); }
        .toast.warn    svg { color: var(--amber); }

        /* ── MOBILE BOTTOM NAV ── */
        .mob-nav {
            display: none;
            position: fixed; bottom: 0; left: 0; right: 0;
            background: var(--black);
            border-top: 1px solid var(--border);
            backdrop-filter: blur(14px);
            padding: 10px 0 max(10px, env(safe-area-inset-bottom));
            z-index: 90;
            justify-content: space-around;
            transition: background .3s, border-color .3s;
        }
        .mob-nav-item {
            display: flex; flex-direction: column; align-items: center; gap: 4px;
            cursor: pointer; padding: 4px 16px;
            color: var(--dim); font-size: 10px; letter-spacing: 1px;
            text-transform: uppercase; transition: color .2s;
        }
        .mob-nav-item svg { width: 20px; height: 20px; }
        .mob-nav-item.active { color: var(--white); }

        /* ══ MOBILE ══ */
        @media (max-width: 768px) {
            .shell { grid-template-columns: 1fr; grid-template-rows: 62px 1fr; }
            .sidebar { display: none; }
            .main { padding: 18px 16px 90px; overflow-x: hidden; }
            .stats { grid-template-columns: 1fr 1fr; }
            .stats .sc:last-child { grid-column: 1 / -1; }
            .bal-section { grid-template-columns: 1fr; }
            .fund-col { flex-direction: row; }
            .fund-btn { flex: 1; min-width: 0; }
            .server-grid { grid-template-columns: 1fr; }
            .logo-text { display: none; }
            .nav-bal { padding: 6px 12px; }
            .bal-card { width: 100%; }
            .bal-big { font-size: clamp(28px, 8vw, 42px); }
            .mob-nav { display: flex; }
        }

        @media (max-width: 400px) {
            .stats { grid-template-columns: 1fr; }
            .stats .sc:last-child { grid-column: auto; }
            .bal-big { font-size: 28px; }
        }

        .main { max-width: 100%; overflow-x: hidden; }

        /* Desktop: sidebar logout at bottom */
        @media (min-width: 769px) {
            .sidebar { justify-content: flex-start; }
            .slink.red { margin-top: auto; }
        }

        /* ── MOBILE PROFILE SHEET ── */
        .mob-sheet-bg {
            display: none; position: fixed; inset: 0; z-index: 95;
            background: rgba(0,0,0,.5); backdrop-filter: blur(4px);
        }
        .mob-sheet-bg.open { display: block; }
        .mob-sheet {
            position: fixed; bottom: 0; left: 0; right: 0; z-index: 96;
            background: var(--black);
            border-top: 1px solid var(--border);
            border-radius: 20px 20px 0 0;
            padding: 10px 20px max(24px, env(safe-area-inset-bottom));
            transform: translateY(100%);
            transition: transform .35s cubic-bezier(.16,1,.3,1), background .3s;
        }
        .mob-sheet.open { transform: translateY(0); }
        .mob-sheet-handle {
            width: 36px; height: 4px; background: var(--border);
            border-radius: 100px; margin: 6px auto 18px;
        }
        .mob-sheet-user {
            display: flex; align-items: center; gap: 14px;
            padding: 0 4px 18px;
            border-bottom: 1px solid var(--border);
            margin-bottom: 8px;
        }
        .mob-sheet-avatar {
            width: 44px; height: 44px; border-radius: 50%;
            background: rgba(243,243,238,.1); border: 1.5px solid var(--border);
            display: grid; place-items: center; flex-shrink: 0;
            font-family: 'Bebas Neue', sans-serif; font-size: 20px; color: var(--white);
        }
        .mob-sheet-name  { font-weight: 700; font-size: 15px; color: var(--white); }
        .mob-sheet-email { font-size: 12px; color: var(--dim); margin-top: 2px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; max-width: 220px; }
        .mob-sheet-item {
            display: flex; align-items: center; justify-content: space-between;
            padding: 14px 4px; cursor: pointer;
            font-size: 14px; color: var(--white);
            border-radius: 8px; transition: background .15s;
        }
        .mob-sheet-item:hover { background: rgba(243,243,238,.05); }
        .mob-sheet-item.red { color: #f87171; }
        .mob-sheet-sep { height: 1px; background: var(--border); margin: 4px 0; }
    </style>
</head>
<body>

<!-- SVG SPRITES -->
<svg xmlns="http://www.w3.org/2000/svg" style="display:none">
    <symbol id="i-withdraw" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M12 19V5M5 12l7-7 7 7"/><line x1="5" y1="19" x2="19" y2="19"/></symbol>
    <symbol id="i-chess"   viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M8 16l-1.447.724A1 1 0 006 17.618V20h12v-2.382a1 1 0 00-.553-.894L16 16H8z"/><rect x="7" y="13" width="10" height="3" rx="1"/><path d="M12 2v2M9 4h6M9 13V7a3 3 0 016 0v6"/></symbol>
    <symbol id="i-wallet"  viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><path d="M20 7H4a2 2 0 00-2 2v9a2 2 0 002 2h16a2 2 0 002-2V9a2 2 0 00-2-2z"/><path d="M16 11h2v2h-2z"/><path d="M20 7V5a2 2 0 00-2-2H6"/></symbol>
    <symbol id="i-trophy"  viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M6 9H3V5h3M18 9h3V5h-3"/><path d="M6 5h12v7a6 6 0 01-12 0V5z"/><path d="M12 18v3M9 21h6"/></symbol>
    <symbol id="i-bolt"    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></symbol>
    <symbol id="i-users"   viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="7" r="4"/><path d="M3 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/><path d="M16 3.13a4 4 0 010 7.75M21 21v-2a4 4 0 00-3-3.87"/></symbol>
    <symbol id="i-home"    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></symbol>
    <symbol id="i-history" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><polyline points="1 4 1 10 7 10"/><path d="M3.51 15a9 9 0 102.13-9.36L1 10"/><line x1="12" y1="7" x2="12" y2="12"/><line x1="12" y1="12" x2="15" y2="14"/></symbol>
    <symbol id="i-settings"viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 012.83-2.83l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 014 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 2.83l-.06.06A1.65 1.65 0 0019.4 9a1.65 1.65 0 001.51 1H21a2 2 0 010 4h-.09a1.65 1.65 0 00-1.51 1z"/></symbol>
    <symbol id="i-logout"  viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></symbol>
    <symbol id="i-user"    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="8" r="4"/><path d="M4 20c0-4 3.6-7 8-7s8 3 8 7"/></symbol>
    <symbol id="i-plus"    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></symbol>
    <symbol id="i-check"   viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></symbol>
    <symbol id="i-warn"    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></symbol>
    <symbol id="i-x"       viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></symbol>
    <symbol id="i-coin"    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"><circle cx="12" cy="12" r="9"/><path d="M9.5 9.5A2.5 2.5 0 0112 8a2.5 2.5 0 010 5 2.5 2.5 0 000 5 2.5 2.5 0 002.5-1.5"/></symbol>
    <symbol id="i-circle"  viewBox="0 0 8 8"><circle cx="4" cy="4" r="4"/></symbol>
    <symbol id="i-sun"     viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></symbol>
    <symbol id="i-game"    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="6" width="20" height="12" rx="2"/><path d="M6 12h4M8 10v4M15 12h2M12 10v4"/></symbol>
</svg>

<div class="bg-grid"></div>

<div class="shell">

    <!-- ══ NAV ══ -->
    <nav class="topnav">
        <a class="nav-logo" href="dashboard.html">
            <div class="logo-mark">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M3 17V3L10 13.5V3" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M10 16.5V6L17 17V3" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>
            <div class="logo-text">nmedea</div>
        </a>
        <div class="nav-right">
            <div class="nav-bal">
                <svg><use href="#i-wallet"/></svg>
                R<span class="nav-bal-amt" id="navBal">0.00</span>
            </div>
            <div class="avatar" id="avatarBtn" onclick="toggleDrop()">
                <span id="avatarLetter">A</span>
                <div class="drop" id="dropMenu">
                    <div class="drop-hd">
                        <div class="drop-name"  id="dName">—</div>
                        <div class="drop-email" id="dEmail">—</div>
                    </div>
                    <div class="drop-sep"></div>
                    <div class="di red" onclick="askLogout()"><svg><use href="#i-logout"/></svg> Sign Out</div>
                </div>
            </div>
        </div>
    </nav>

    <!-- ══ SIDEBAR (desktop only) ══ -->
    <aside class="sidebar">
        <div class="s-lbl">Menu</div>
        <a class="slink active" id="sb-dashboard" onclick="showSection('dashboard')"><svg><use href="#i-home"/></svg> Dashboard</a>
        <a class="slink" id="sb-history" onclick="showSection('history')"><svg><use href="#i-history"/></svg> Game History</a>
        <div class="s-lbl">Account</div>
        <div style="padding: 10px 11px 6px;">
            <div style="font-size:13px;font-weight:700;color:var(--white);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;" id="sideProfileName">—</div>
            <div style="font-size:11px;color:var(--dim);margin-top:2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;" id="sideProfileEmail">—</div>
        </div>
        <a class="slink theme-toggle" onclick="toggleTheme(event)" style="justify-content:space-between;">
            <span style="display:flex;align-items:center;gap:10px"><svg><use href="#i-sun"/></svg> Light Mode</span>
            <div class="toggle-switch" id="themeSwitch"><div class="toggle-knob"></div></div>
        </a>
        <a class="slink red" onclick="askLogout()"><svg><use href="#i-logout"/></svg> Sign Out</a>
    </aside>

    <!-- ══ MAIN ══ -->
    <main class="main">

        <!-- DASHBOARD SECTION -->
        <div id="section-dashboard">
            <div class="pg-eyebrow">Welcome back</div>
            <div class="pg-title" id="pgTitle">DASHBOARD</div>

            <!-- Stats -->
            <div class="stats">
                <div class="sc">
                    <div class="sc-top">
                        <div class="sc-lbl">Games Played</div>
                        <div class="sc-ico"><svg><use href="#i-bolt"/></svg></div>
                    </div>
                    <div class="sc-val" id="statPlayed">0</div>
                    <div class="sc-sub">All time</div>
                </div>
                <div class="sc">
                    <div class="sc-top">
                        <div class="sc-lbl">Games Won</div>
                        <div class="sc-ico"><svg><use href="#i-trophy"/></svg></div>
                    </div>
                    <div class="sc-val" id="statWon">0</div>
                    <div class="sc-sub" id="statWinRate">Win rate: —</div>
                </div>
                <div class="sc">
                    <div class="sc-top">
                        <div class="sc-lbl">Total Earned</div>
                        <div class="sc-ico"><svg><use href="#i-coin"/></svg></div>
                    </div>
                    <div class="sc-val" id="statEarned">R0</div>
                    <div class="sc-sub">Lifetime winnings</div>
                </div>
            </div>

            <!-- Balance + Add Funds -->
            <div class="bal-section">
                <div class="bal-card">
                    <div>
                        <div class="bal-lbl">Available Balance</div>
                        <div class="bal-big">R<span id="balDisplay">0.00</span></div>
                        <div class="bal-sub">Ready to play · R10 per game</div>
                    </div>
                    <div class="bal-icon"><svg><use href="#i-wallet"/></svg></div>
                </div>

                <div class="fund-col">
                    <button class="fund-btn" onclick="openPay(10)">
                        <svg><use href="#i-plus"/></svg> Add R10
                    </button>
                    <button class="fund-btn withdraw" onclick="openWithdraw()">
                        <svg><use href="#i-withdraw"/></svg> Withdraw
                    </button>
                </div>
            </div>

            <!-- Servers -->
            <div class="sec-row">
                <div class="sec-ttl">CHOOSE A SERVER</div>
                <div class="sec-note">R10 entry · R18 prize</div>
            </div>

            <div class="server-grid" id="serverGrid"></div>
        </div>

        <!-- HISTORY SECTION -->
        <div id="section-history" style="display:none">
            <div class="pg-eyebrow">Your activity</div>
            <div class="pg-title">HISTORY</div>
            <div class="hist-list" id="histList"></div>
        </div>

    </main>
</div>

<!-- ── MOBILE BOTTOM NAV ── -->
<nav class="mob-nav">
    <div class="mob-nav-item active" id="mob-dashboard" onclick="showSection('dashboard')">
        <svg><use href="#i-home"/></svg>
        Home
    </div>
    <div class="mob-nav-item" id="mob-history" onclick="showSection('history')">
        <svg><use href="#i-history"/></svg>
        History
    </div>
    <div class="mob-nav-item" id="mob-profile" onclick="toggleMobProfile()">
        <svg><use href="#i-user"/></svg>
        Profile
    </div>
</nav>

<!-- ── MOBILE PROFILE SHEET ── -->
<div class="mob-sheet-bg" id="mobSheetBg" onclick="closeMobProfile()"></div>
<div class="mob-sheet" id="mobSheet">
    <div class="mob-sheet-handle"></div>
    <div class="mob-sheet-user">
        <div class="mob-sheet-avatar" id="mobAvatar">A</div>
        <div>
            <div class="mob-sheet-name" id="mobName">—</div>
            <div class="mob-sheet-email" id="mobEmail">—</div>
        </div>
    </div>
    <div class="mob-sheet-item" onclick="toggleTheme(event); closeMobProfile();">
        <span style="display:flex;align-items:center;gap:12px"><svg width="18" height="18"><use href="#i-sun"/></svg> Light Mode</span>
        <div class="toggle-switch" id="themeSwitchMob"><div class="toggle-knob"></div></div>
    </div>
    <div class="mob-sheet-sep"></div>
    <div class="mob-sheet-item red" onclick="closeMobProfile(); askLogout();">
        <span style="display:flex;align-items:center;gap:12px"><svg width="18" height="18"><use href="#i-logout"/></svg> Sign Out</span>
    </div>
</div>

<!-- ══ PAYMENT MODAL (Yoco popup triggered) ══ -->
<!-- Yoco handles the card UI via SDK popup -->

<!-- ══ WITHDRAW MODAL ══ -->
<div class="overlay" id="wdOverlay" onclick="handleOverlayClick(event,'wdOverlay')">
    <div class="mbox">
        <div class="m-head">
            <div class="m-title">WITHDRAW</div>
            <button class="m-close" onclick="closeWithdraw()"><svg><use href="#i-x"/></svg></button>
        </div>
        <div class="wd-info">
            Minimum withdrawal is <strong>R20</strong>. Requests are processed within 24 hours.
        </div>
        <div class="wd-req">
            <span class="wd-req-lbl">Your balance</span>
            <span class="wd-req-val">R<span id="wdBalAmt">0.00</span></span>
        </div>
        <div class="wd-req">
            <span class="wd-req-lbl">Minimum required</span>
            <span class="wd-req-val" style="color:var(--amber)">R20</span>
        </div>
        <div class="mf">
            <label>Amount to withdraw</label>
            <input type="number" id="wdAmt" placeholder="e.g. 20" min="20" inputmode="numeric">
        </div>
        <div class="mf">
            <label>Bank / Account details</label>
            <input type="text" id="wdBank" placeholder="e.g. FNB – 62XXXXXXXX">
        </div>
        <button class="btn-pay" onclick="submitWithdraw()">
            <span class="bt">Request Withdrawal</span>
        </button>
    </div>
</div>

<!-- ══ PROCESSING ══ -->
<div class="proc" id="procOv">
    <div class="dot-loader">
        <span></span><span></span><span></span>
    </div>
    <div class="proc-txt" id="procTxt">Processing...</div>
</div>

<!-- ══ LOGOUT CONFIRM ══ -->
<div class="confirm-overlay" id="confirmOv">
    <div class="confirm-box">
        <div class="confirm-icon"><svg><use href="#i-logout"/></svg></div>
        <div class="confirm-title">SIGNING OUT?</div>
        <div class="confirm-msg">You'll need to sign in again to access your account. Your balance is safely stored.</div>
        <div class="confirm-btns">
            <button class="btn-cancel-c" onclick="closeConfirm()">Stay</button>
            <button class="btn-confirm-c" onclick="doLogout()">Sign Out</button>
        </div>
    </div>
</div>

<!-- ══ TOAST ══ -->
<div class="toast" id="toast">
    <svg id="toastIco"><use href="#i-check"/></svg>
    <span id="toastTxt"></span>
</div>

<script>
    // ── YOCO SDK ──
    var yoco = new YocoSDK({ publicKey: 'pk_live_3fa50d60wE6ZogWa2474' });

    let user    = null;
    let balance = 0;

    const servers = [
        { id: 1, name: 'SERVER 1', speed: 'FAST',   state: 'open',     player1: null },
        { id: 2, name: 'SERVER 2', speed: 'FAST',   state: 'waiting',  player1: 'Thabo M.' },
        { id: 3, name: 'SERVER 3', speed: 'MEDIUM', state: 'reserved', player1: 'Sipho K.', player2: 'Zanele D.' },
        { id: 4, name: 'SERVER 4', speed: 'FAST',   state: 'open',     player1: null },
    ];

    // ── SECTION NAV ──
    function showSection(name) {
        ['dashboard','history'].forEach(s => {
            const el = document.getElementById('section-' + s);
            if (s === name) {
                el.style.display = '';
                el.classList.add('section-panel');
                // Remove class after animation so it can replay
                setTimeout(() => el.classList.remove('section-panel'), 300);
            } else {
                el.style.display = 'none';
            }
            const sb = document.getElementById('sb-' + s);
            if (sb) sb.classList.toggle('active', s === name);
            const mb = document.getElementById('mob-' + s);
            if (mb) mb.classList.toggle('active', s === name);
        });
        document.getElementById('mob-profile').classList.remove('active');
        if (name === 'history') renderHistory();
        document.getElementById('dropMenu').classList.remove('open');
    }

    // ── AUTH ──
    window.addEventListener('DOMContentLoaded', () => {
        const saved = localStorage.getItem('draughtsUser');
        if (!saved) { location.href = 'index.html'; return; }

        user    = JSON.parse(saved);
        balance = parseFloat(localStorage.getItem('draughtsBalance')) || 0;

        // Apply saved theme
        if (localStorage.getItem('draughtsTheme') === 'light') {
            document.body.classList.add('light');
            document.getElementById('themeSwitch').classList.add('on');
            const mobSw = document.getElementById('themeSwitchMob');
            if (mobSw) mobSw.classList.add('on');
        }

        const letter = user.name.charAt(0).toUpperCase();
        document.getElementById('avatarLetter').textContent = letter;
        document.getElementById('dName').textContent        = user.name;
        document.getElementById('dEmail').textContent       = user.email || user.phone || '—';
        document.getElementById('pgTitle').textContent      = 'WELCOME, ' + user.name.split(' ')[0].toUpperCase();
        document.getElementById('sideProfileName').textContent  = user.name;
        document.getElementById('sideProfileEmail').textContent = user.email || user.phone || '—';
        // Mobile sheet
        document.getElementById('mobAvatar').textContent = letter;
        document.getElementById('mobName').textContent   = user.name;
        document.getElementById('mobEmail').textContent  = user.email || user.phone || '—';

        updateBal();
        updateStats();
        renderServers();
        setInterval(simulateLive, 8000);
    });

    function updateBal() {
        const v = balance.toFixed(2);
        document.getElementById('balDisplay').textContent = v;
        document.getElementById('navBal').textContent     = v;
        document.getElementById('wdBalAmt').textContent   = v;
    }

    // ── STATS ──
    function updateStats() {
        const history = JSON.parse(localStorage.getItem('draughtsHistory') || '[]');
        const games   = history.filter(h => h.type === 'win' || h.type === 'loss');
        const wins    = history.filter(h => h.type === 'win');
        const earned  = wins.reduce((sum, h) => sum + (h.amount || 0), 0);
        document.getElementById('statPlayed').textContent = games.length;
        document.getElementById('statWon').textContent    = wins.length;
        document.getElementById('statWinRate').textContent = games.length
            ? 'Win rate: ' + Math.round(wins.length / games.length * 100) + '%'
            : 'Win rate: —';
        document.getElementById('statEarned').textContent = 'R' + earned;
    }

    // ── HISTORY ──
    function addHistory(entry) {
        const hist = JSON.parse(localStorage.getItem('draughtsHistory') || '[]');
        hist.unshift({ ...entry, time: new Date().toISOString() });
        localStorage.setItem('draughtsHistory', JSON.stringify(hist));
    }

    function renderHistory() {
        const hist = JSON.parse(localStorage.getItem('draughtsHistory') || '[]');
        const list = document.getElementById('histList');
        if (!hist.length) {
            list.innerHTML = `<div class="hist-empty"><div class="hist-empty-ico"><svg width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="1 4 1 10 7 10"/><path d="M3.51 15a9 9 0 102.13-9.36L1 10"/><line x1="12" y1="7" x2="12" y2="12"/><line x1="12" y1="12" x2="15" y2="14"/></svg></div>No history yet. Play a game!</div>`;
            return;
        }
        list.innerHTML = hist.map(h => {
            const icoClass = h.type === 'win' ? 'win' : h.type === 'loss' ? 'loss' : h.type === 'deposit' ? 'dep' : 'with';
            const icoIcon  = h.type === 'win' ? '#i-trophy' : h.type === 'loss' ? '#i-bolt' : h.type === 'deposit' ? '#i-plus' : '#i-withdraw';
            const amtClass = h.type === 'win' || h.type === 'deposit' ? 'pos' : h.type === 'loss' ? 'neg' : 'neu';
            const amtSign  = h.type === 'win' || h.type === 'deposit' ? '+' : '-';
            const title    = h.type === 'win' ? 'Game Won' : h.type === 'loss' ? 'Game Lost' : h.type === 'deposit' ? 'Funds Added' : 'Withdrawal';
            const d = new Date(h.time);
            const timeStr  = d.toLocaleDateString('en-ZA', { day:'numeric', month:'short', year:'numeric' }) + ' · ' + d.toLocaleTimeString('en-ZA', { hour:'2-digit', minute:'2-digit' });
            return `
                <div class="hist-item">
                    <div class="hist-left">
                        <div class="hist-ico ${icoClass}"><svg><use href="${icoIcon}"/></svg></div>
                        <div>
                            <div class="hist-title">${title}</div>
                            <div class="hist-time">${timeStr}</div>
                        </div>
                    </div>
                    <div class="hist-amt ${amtClass}">${amtSign}R${h.amount}</div>
                </div>`;
        }).join('');
    }

    // ── RENDER SERVERS ──
    function renderServers() {
        const grid = document.getElementById('serverGrid');
        grid.innerHTML = '';
        servers.forEach(srv => {
            const isOpen     = srv.state === 'open';
            const isWaiting  = srv.state === 'waiting';
            const isReserved = srv.state === 'reserved';
            const badgeClass = isOpen ? 'badge-open' : isWaiting ? 'badge-waiting' : 'badge-reserved';
            const badgeTxt   = isOpen ? 'Open' : isWaiting ? 'Player Waiting' : 'Reserved';
            const speedColor = srv.speed === 'FAST' ? 'color:var(--green)' : 'color:var(--amber)';
            const slot1HTML  = isOpen ? `<div class="slot">Empty</div>` : `<div class="slot filled">${srv.player1}</div>`;
            const slot2HTML  = isReserved
                ? `<div class="slot filled">${srv.player2}</div>`
                : isWaiting
                    ? `<div class="slot" style="border-color:rgba(243,243,238,.25);color:rgba(243,243,238,.4);">You?</div>`
                    : `<div class="slot">Empty</div>`;
            const btnHTML = isReserved
                ? `<button class="srv-btn" disabled><span>Reserved</span></button>`
                : `<button class="srv-btn" onclick="joinServer(${srv.id})"><span>${isWaiting ? 'Join &amp; Play Now' : 'Join Server'}</span></button>`;

            const card = document.createElement('div');
            card.className = 'srv' + (isReserved ? ' reserved' : '');
            card.innerHTML = `
                <div class="srv-top">
                    <div class="srv-name">${srv.name}</div>
                    <div class="srv-badge ${badgeClass}">
                        <svg style="fill:currentColor"><use href="#i-circle"/></svg>
                        ${badgeTxt}
                    </div>
                </div>
                <div class="srv-info">
                    <div class="srv-info-item" style="${speedColor}">
                        <svg><use href="#i-bolt"/></svg> ${srv.speed}
                    </div>
                    <div class="srv-info-item">
                        <svg><use href="#i-users"/></svg>
                        ${isReserved ? '2/2 players' : isWaiting ? '1/2 players' : '0/2 players'}
                    </div>
                </div>
                <div class="slots">
                    ${slot1HTML}
                    <div class="slots-vs">VS</div>
                    ${slot2HTML}
                </div>
                ${btnHTML}
            `;
            grid.appendChild(card);
        });
    }

    function simulateLive() {
        servers.forEach(srv => {
            if (srv.state === 'open' && Math.random() > 0.6) {
                const names = ['Bongani','Lerato','Nomsa','Sipho','Thandi','Mpho','Kagiso'];
                srv.state   = 'waiting';
                srv.player1 = names[Math.floor(Math.random()*names.length)] + ' M.';
            } else if (srv.state === 'waiting' && Math.random() > 0.7) {
                srv.state   = 'open';
                srv.player1 = null;
            }
        });
        renderServers();
    }

    function joinServer(id) {
        if (balance < 10) {
            showToast('Add funds first — you need at least R10', 'warn');
            return;
        }
        balance -= 10;
        localStorage.setItem('draughtsBalance', balance.toString());
        updateBal();
        addHistory({ type: 'loss', amount: 10 }); // deduct entry fee (game result handled in game.html)
        updateStats();
        localStorage.setItem('selectedServer', id.toString());
        location.href = 'game.html';
    }

    // ── PAYMENT via Yoco ──
    function openPay(amt) {
        location.href = 'pay.html?amt=' + amt;
    }

    // ── OVERLAY HELPERS ──
    let _scrollY = 0;
    function lockScroll() {
        _scrollY = window.scrollY;
        document.body.style.top = '-' + _scrollY + 'px';
        document.body.classList.add('modal-open');
        document.documentElement.classList.add('modal-open');
    }
    function unlockScroll() {
        document.body.classList.remove('modal-open');
        document.documentElement.classList.remove('modal-open');
        document.body.style.top = '';
        window.scrollTo(0, _scrollY);
    }

    function handleOverlayClick(e, overlayId) {
        if (e.target.id === overlayId) {
            document.getElementById(overlayId).classList.remove('open');
            unlockScroll();
        }
    }

    // ── WITHDRAW ──
    function openWithdraw() {
        document.getElementById('wdAmt').value  = '';
        document.getElementById('wdBank').value = '';
        document.getElementById('wdOverlay').classList.add('open');
        lockScroll();
    }
    function closeWithdraw() {
        document.getElementById('wdOverlay').classList.remove('open');
        unlockScroll();
    }

    function submitWithdraw() {
        const amt  = parseFloat(document.getElementById('wdAmt').value);
        const bank = document.getElementById('wdBank').value.trim();
        if (balance < 20) {
            showToast('Minimum withdrawal is R20', 'warn'); return;
        }
        if (!amt || amt < 20) {
            showToast('Minimum withdrawal amount is R20', 'warn'); return;
        }
        if (amt > balance) {
            showToast('Amount exceeds your balance', 'warn'); return;
        }
        if (!bank) {
            showToast('Please enter your bank details', 'warn'); return;
        }
        closeWithdraw();
        addHistory({ type: 'withdraw', amount: amt });
        balance -= amt;
        localStorage.setItem('draughtsBalance', balance.toString());
        updateBal();
        updateStats();
        showToast('Withdrawal request submitted! 24hr processing.', 'success');
    }

    // ── MOBILE PROFILE SHEET ──
    function toggleMobProfile() {
        const sheet = document.getElementById('mobSheet');
        const bg    = document.getElementById('mobSheetBg');
        const isOpen = sheet.classList.contains('open');
        if (isOpen) { closeMobProfile(); } else {
            sheet.classList.add('open');
            bg.classList.add('open');
            lockScroll();
            document.getElementById('mob-profile').classList.add('active');
        }
    }
    function closeMobProfile() {
        document.getElementById('mobSheet').classList.remove('open');
        document.getElementById('mobSheetBg').classList.remove('open');
        unlockScroll();
        document.getElementById('mob-profile').classList.remove('active');
    }

    // ── THEME ──
    function toggleTheme(e) {
        if (e) e.stopPropagation();
        const isLight = document.body.classList.toggle('light');
        const sw1 = document.getElementById('themeSwitch');
        const sw2 = document.getElementById('themeSwitchMob');
        if (sw1) sw1.classList.toggle('on', isLight);
        if (sw2) sw2.classList.toggle('on', isLight);
        localStorage.setItem('draughtsTheme', isLight ? 'light' : 'dark');
    }

    // ── PROFILE DROPDOWN ──
    function toggleDrop() { document.getElementById('dropMenu').classList.toggle('open'); }
    document.addEventListener('click', e => {
        if (!document.getElementById('avatarBtn').contains(e.target))
            document.getElementById('dropMenu').classList.remove('open');
    });

    // ── LOGOUT ──
    function askLogout() {
        document.getElementById('dropMenu').classList.remove('open');
        document.getElementById('confirmOv').classList.add('open');
    }
    function closeConfirm() { document.getElementById('confirmOv').classList.remove('open'); }
    function doLogout() {
        localStorage.removeItem('draughtsUser');
        localStorage.removeItem('draughtsBalance');
        location.href = 'index.html';
    }

    // ── TOAST ──
    function showToast(msg, type = 'success') {
        const t   = document.getElementById('toast');
        const ico = document.getElementById('toastIco');
        document.getElementById('toastTxt').textContent = msg;
        ico.innerHTML = type === 'warn' ? '<use href="#i-warn"/>' : '<use href="#i-check"/>';
        t.className = 'toast ' + type + ' show';
        setTimeout(() => t.classList.remove('show'), 3200);
    }
</script>
</body>
</html>
